Los autores, José Santos y Ángel Monteagudo, decidieron utilizar un autómata celular
siguiendo un modelo de eventos. Es decir, por un lado, la simulación se realiza
sobre una rejilla en tres dimensiones, comenzando con una única célula en el centro de la misma.
Por otro lado, se programan una serie de eventos para cada una de las células de la rejilla, aleatoriamente
entre 5 y 10 (ambos inclusive) iteraciones en el futuro.

Las características y propiedades del sistema se describen en las secciones de este capítulo que
se muestran a continuación.

\section{Las células, genoma y propiedades}

Cada célula estará alojada en una única posición del autómata. En esta simulación, no se modeliza
el tamaño de las células, es decir, aunque en las células cancerosas se observa, además de un comportamiento
replicativo sin control, un crecimiento en su tamaño sin control, los autores no han tenido en cuenta esto.

El genoma de cada célula presente en la rejilla cuenta con un genoma y unas propiedades únicas para cada una de ellas.
En cuanto a su genoma, cuenta con 5 variables binarias que representan la presencia o no de una mutación, la cual, define
un determinado comportamiento canceroso. Estas mutaciones son las siguientes:

\begin{itemize}
    \item \textbf{SG}: Autogeneración de los mensajes de crecimeinto. Esto es, la mutación que permite que la
    célula genere sus propios mensajes para ejecutar la división con idependencia externa.
    \item \textbf{IGI}: Inhibición de las señales de anticrecimiento. Esto es, ante la recepción de una orden
    de detener su crecimiento, la célula tiene una mutación que le permite un mecanismo de ignorancia de los mismos.
    \item \textbf{EA}: Evasión de apoptosis. Esto es, la célula puede, mediante mutación, no hacer caso ante
    una orden de apoptosis, o muerte celular controlada.
    \item \textbf{EI}: Inmortalidad efectiva. Esto es, la célula adquiere una mutación que permite evitar un límite
    replicativo existente, entre otros factores, por el tamaño del telómero.
    \item \textbf{GI}: Inestabilidad genética. Esto es, una mutación que permite a la célula acumular más daño genético, es decir,
    la tasa de mutación base se va incrementando con el paso del tiempo.
\end{itemize}

Además, cada célula tiene una tasa de mutación base y un tamaño de telómero. El primero, es utilizado a la hora
de añadir nuevas mutaciones a la célula. Y la segunda, es un límite replicativo debido a que el ADN queda
desprotegido para futuras mutaciones y podrían ocurrir errores.

\section{Parámetros globales}

De cara a la simulación, existen una serie de parámetros globales que inciden en determinados mecanismos y,
por tanto, afectan en su evolución. Esto son:

\begin{itemize}
    \item \textbf{t}: Tamaño de la rejilla.
    \item \textbf{m}: Valor por defecto que indica la tasa de mutación base de cada célula al inicio.
    \item \textbf{tl}: Valor por defecto que indica el tamaño del telómero de cada célula al inicio.
    \item \textbf{e}: Valor por defecto utilizado para definir la probabilidad de una célula de morir por daño genético.
    \item \textbf{i}: Valor por defecto utilizado como factor de aumento de la tasa de mutación base de las células.
    \item \textbf{g}: Valor por defecto para ver qué probabilidad hay de que una célula cancerosa mate a un vecino para
    poder reproducirse.
    \item \textbf{a}: Valor por defecto para ver con qué probabilidad una célula muere de forma aleatoria. Este parámetro
    se introduce como forma de simular las muy diversas causas que pueden originar en la muerte de la célula, por ejemplo,
    recibir una alta dosis de radiación entre otras.
\end{itemize}

\section{Pruebas previas a la mitosis}

El modelo de eventos, a la hora de realizar la mitosis (división celular), realiza tres pruebas:

\begin{itemize}
    \item \textbf{Prueba de muerte aleatoria}: La célula muere con una probabilidad dada ($1/a$).
    \item \textbf{Prueba de daño genético}: A mayor cantidad de mutaciones, mayor probabilidad de
    que la célula muera ($n/e$, donde n es el número de mutaciones de la célula). Excepto, que
    la célula tenga la mutación $EA$ presente en su genoma.
    \item \textbf{Prueba de mitosis}: En realidad, se trata de tres pruebas cuyo resultado debe
    ser positivo para que la célula pueda ejecutar la mitosis:
    \begin{itemize}
        \item \textbf{Comprobación del factor de crecimiento}: La célula sólo puede realizar la
        mitosis si se encuentra dentro de un límite espacial predefinido. Es decir, hay suficiente
        factor de crecimiento. Fuera de este área no podrá realizar la mitosis, excepto si el
        marcador $SG$ está activo.
        \item \textbf{Comprobación de ignorancia de inhibición de crecimiento}: Si no hay
        espacio en el vecindario, la célula no podrá realizar la división. Excepto, que
        la mutación $IGI$ esté presente, en cuyo caso, reemplazará a un vecino con una
        probabilidad dada ($1/g$).
        \item \textbf{Comprobación de potencial replicativo sin límites}: Si el tamaño del telómero
        es 0, la célula muere. Excepto si el marcador $EI$ está presente.
    \end{itemize}
\end{itemize}

En estas pruebas, se utilizan los parámetros globales, además, de las propiedades y el genóma de la célula.

Por tanto, si una célula pasa todas las pruebas podrá entrar en fase de mitosis.

\section{Mitosis}

La mitosis es la fase donde se realiza la división celular, lo cual origina una nueva célula, llamada
célula hija, que es una copia exacta de la célula original.

Durante este proceso, se pueden producir una serie de errores, bien de forma natural, o bien, debido
mutaciones presentes en la célula original que hacen más probable un error.

En este trabajo, el proceso de mitosis cuenta con los siguientes pasos:

\begin{itemize}
    \item Incremento de la tasa de mutación base $m$ (de acuerdo al parámetro golbal $i$) si el marcador
    $GI$ está presente.
    \item Añadir nuevas mutaciones a la célula de acuerdo a la tasa base de mutación ($1/m$).
    \item Decrementar el telómero en ambas células en una unidad, siempre que su tamaño no sea 0.
\end{itemize}

A continuación, se programan nuevos eventos mitóticos para ambas hijas como se describe a continuación.

\section{Eventos mitóticos}

Un evento mitotico se puede ver como la posibilidad de que una célula ejecute o no la división (o mitosis),
en el futuro.

Todas las células en la rejilla contarán con un evento mitótico en el futuro. Cuando se selecciona una
de las candidatas en cada iteración la célula candidata debe pasar las pruebas previas a la mitosis para ver
si la misma puede o no ejecutar la mitosis. Si el resultado es positivo, se realiza la mitosis y se crean
nuevos eventos mitóticos en el futuro para la célula original y, también, para la célula hija.
Si el resultado es negativo, pero la célula no ha muerto, se programa un nuevo evento mitótico en el futuro.

La programación de eventos mitóticos futuros consiste en la generación, de forma aleatoria, de un valor
entre 5 y 10 iteraciones (ambas inclusive) del bucle principal. Estos valores tienen que ver con el ciclo de vida
temporal de las células, sobre el cual, se detalla más información en la siguiente sección.

\section{Equivalencia temporal}

El ciclo de vida de las células biológicas es de entre 15 y 24 horas. Este ciclo se divide en 5 fases, que son:
fase G0, fase G1, fase S, fase G2 y fase M.

Una célula parte en fase de reposo (G0). Si hay espacio suficiente a su alrededor (vecindario) automáticamente pasa
a fase G1. En la simulación, G1 se simula mediante el paso del tiempo (iteraciones) y la programación de
eventos mitóticos en el futuro (entre 5 y 10 iteraciones, ambas inclusive). Además, en la simulación no se
tiene en cuenta el crecimiento celular.

La fase S es cuando tiene lugar la replicación del ADN. La cual, puede introduccir una mutación ocasionalmente.
La célula entra en una última fase previa a la mitosos, llamada fase G2, en la cual se producen una serie
de comprobaciones sobre el daño genético. Esto, puede provocar la apoptosis (muerte celular programada) en la célula.

Finalmente, la célula entra en la fase M o de mitosis. Todo este ciclo, que en la simulación toma entre 5 y 10 iteraciones
(15 y 24 horas en células biológicas) da una media de 2,6 horas por iteración. Por ejemplo, para 5000 iteraciones se tienen
unas 77,4 semanas aproximadamente.

\section{Bucle principal del modelo de eventos}

\begin{figure}[h]
\centering
\includegraphics[scale=0.4]{figures/pseudo_alg}
\caption{Modelo de eventos para simulación del cáncer.}
\end{figure}
